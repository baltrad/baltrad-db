Import("env")

env.AppendUnique(CPPPATH=["${jdk_include_dir}", "${jdk_include_dir}/linux"])

sources = ["FileCatalog.i"]

Execute(Delete(env.Dir(".").Dir("eu")))
Execute(Mkdir(env.Dir(".").Dir("eu/baltrad/fc")))
build_dir = env.Dir(".").get_abspath()

env["JARCHDIR"] = build_dir + "/classes"
env["JAVASOURCEPATH"] = build_dir

env.Append(SWIGFLAGS="-c++ -java -package eu.baltrad.fc".split())
env.Append(SWIGOUTDIR=build_dir + "/eu/baltrad/fc")
env.Append(SWIGPATH=env["CPPPATH"])

env.AlwaysBuild("FileCatalog_wrap.cc")

lib = env.SharedLibrary("#lib/brfc_java", sources, LIBS=["brfc"])

confdeps = env.ConfHas("#java-wrapper-confdeps", ["jni", "qt", "hlhdf"])

env.Requires(lib, confdeps)

env.Clean(lib, Dir(".").Dir("eu"))

java = env.Java(target="classes", source=["eu", "java"])
jar = env.Jar(target="#lib/jbrfc.jar", source=["classes/eu"])

env.Alias("java-wrapper", [lib, java, jar])

env.Install("${install_root}/lib", lib)
env.Install("${install_root}/java", jar)

# vim:filetype=python:et:ts=4:sw=4:
